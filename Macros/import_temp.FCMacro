import sys
import os

# Ensure the project root is in the path
project_root = os.path.expanduser("~/Rudder_Code")
if project_root not in sys.path:
    sys.path.append(project_root)

import FreeCAD as App
import FreeCADGui as Gui
import outline.stock.stock2d as stock2d

# Create a new document
doc = App.newDocument("TestStockDrawing")

# Build the 3D stock from the CSV
part_obj = stock2d.build_stock_from_csv(doc)

# Extract bounding box to get length and diameter
bbox = part_obj.Shape.BoundBox
length = bbox.ZLength
diameter = max(bbox.XLength, bbox.YLength)

# Create the drawing page with correct dimensions
stock2d.create_drawing_page(doc, part_obj, length, diameter)

# Show the result
Gui.activeDocument().activeView().viewAxonometric()
Gui.SendMsgToActiveView("ViewFit")